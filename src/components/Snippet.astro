---
import { createStarryNight, all } from "@wooorm/starry-night";
import { toHtml } from "hast-util-to-html";
import { h } from "hastscript";

interface Props {
    code: string;
    lang: string;
}

const { code, lang } = Astro.props;

// Inicializa o engine
const starryNight = await createStarryNight(all);
const scope = starryNight.flagToScope(lang);

// Se n√£o encontrar a linguagem, renderiza texto puro
const tree = scope ? starryNight.highlight(code, scope) : h(undefined, [code]);
const highlightedHtml = toHtml(tree);
---

<pre
    class="text-codeText text-sm overflow-scroll max-h-[600px]">
<code class={`language-${lang} starry-night`} set:html={highlightedHtml} />
</pre>
